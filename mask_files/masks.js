function _MaskAPI(){this.version="0.4b",this.instances=0,this.objects={}}function Mask(e,t){this.mask=e,this.type="string"==typeof t?t:"string",this.error=[],this.errorCodes=[],this.value="",this.strippedValue="",this.allowPartial=!1,this.id=MaskAPI.instances++,this.ref="MaskAPI.objects['"+this.id+"']",MaskAPI.objects[this.id]=this}function qEvent(e){if(window.Event){var t="key"==e.type.substring(0,3);this.keyCode=t?parseInt(e.which,10):0,this.button=t?0:parseInt(e.which,10),this.srcElement=e.target,this.type=e.type,this.x=e.pageX,this.y=e.pageY,this.screenX=e.screenX,this.screenY=e.screenY,document.layers?(this.altKey=(e.modifiers&Event.ALT_MASK)>0,this.ctrlKey=(e.modifiers&Event.CONTROL_MASK)>0,this.shiftKey=(e.modifiers&Event.SHIFT_MASK)>0,this.keyCode=this.translateKeyCode(this.keyCode)):(this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey)}else e=window.event,this.keyCode=parseInt(e.keyCode,10),this.button=e.button,this.srcElement=e.srcElement,this.type=e.type,document.all?(this.x=e.clientX+document.body.scrollLeft,this.y=e.clientY+document.body.scrollTop):(this.x=e.clientX,this.y=e.clientY),this.screenX=e.screenX,this.screenY=e.screenY,this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey;0==this.button&&(this.setKeyPressed(this.keyCode),this.keyChar=String.fromCharCode(this.keyCode))}function $addEvent(e,t,s,r){var i=t.toLowerCase(),n="boolean"!=typeof r||r,a=e[i]?e[i].toString():"";return a=a.substring(a.indexOf("{")+1,a.lastIndexOf("}")),a=(n?a+s:s+a)+"\n",e[i]=window.Event?new Function("event",a):new Function(a)}MaskAPI=new _MaskAPI,Mask.prototype.attach=function(e){$addEvent(e,"onkeydown","return "+this.ref+".isAllowKeyPress(event, this);",!0),$addEvent(e,"onkeyup","return "+this.ref+".getKeyPress(event, this);",!0),$addEvent(e,"onblur","this.value = "+this.ref+".format(this.value);",!0)},Mask.prototype.isAllowKeyPress=function(e,t){if("string"!=this.type)return!0;var s=new qEvent(e);return!(s.keyCode>47&&t.value.length>=this.mask.length&&!s.ctrlKey)},Mask.prototype.getKeyPress=function(e,t,s){this.allowPartial=!0;var r=new qEvent(e);if(r.keyCode>47||1==s||8==r.keyCode||46==r.keyCode){var i,n=t.value;i=8==r.keyCode||46==r.keyCode,"number"==this.type?this.value=this.setNumber(n,i):"date"==this.type?this.value=this.setDateKeyPress(n,i):this.value=this.setGeneric(n,i),t.value=this.value}return this.allowPartial=!1,!0},Mask.prototype.format=function(e){return"number"==this.type?this.value=this.setNumber(e):"date"==this.type?this.value=this.setDate(e):this.value=this.setGeneric(e),this.value},Mask.prototype.throwError=function(e,t,s){return this.error[this.error.length]=t,this.errorCodes[this.errorCodes.length]=e,"string"!=typeof s||s},Mask.prototype.setGeneric=function(e,t){var s,r,i=e,n=this.mask,a=[],h="",l=[],o=0,c={x:"A-Za-z","#":"0-9","*":"A-Za-z0-9"};i=i.replace(new RegExp("[^"+c["*"]+"]","gi"),""),1==t&&i.length==this.strippedValue.length&&(i=i.substring(0,i.length-1)),this.strippedValue=i;for(var g=0;g<n.length;g++)r=n.charAt(g),s="x#*".indexOf(r)>-1,"!"==r&&(r=n.charAt(g++)),(s&&!this.allowPartial||s&&this.allowPartial&&a.length<i.length)&&(a[a.length]="["+c[r]+"]"),l[l.length]={chr:r,mask:s};var u=!1;if(!this.allowPartial&&!new RegExp(a.join("")).test(i))return this.throwError(1,'The value "'+e+'" must be in the format '+this.mask+".",e);if(this.allowPartial&&i.length>0||!this.allowPartial)for(g=0;g<l.length;g++){if(l[g].mask){for(;i.length>0&&!new RegExp(a[o]).test(i.charAt(o));)i=1==i.length?"":i.substring(1);i.length>0&&(h+=i.charAt(o),u=!0),o++}else h+=l[g].chr;if(this.allowPartial&&o>i.length)break}return this.allowPartial&&!u&&(h=""),this.allowPartial&&(h.length<l.length?this.nextValidChar=c[l[h.length].chr]:this.nextValidChar=null),h},Mask.prototype.setNumber=function(e,t){var s=String(e).replace(/[^\d.-]*/gi,""),r=this.mask;if(s=s.replace(/\./,"d").replace(/\./g,"").replace(/d/,"."),!/^[\$]?((\$?[\+-]?([0#]{1,3},)?[0#]*(\.[0#]*)?)|([\+-]?\([\+-]?([0#]{1,3},)?[0#]*(\.[0#]*)?\)))$/.test(r))return this.throwError(1,"An invalid mask was specified for the \nMask constructor.",e);if(1==t&&s.length==this.strippedValue.length&&(s=s.substring(0,s.length-1)),this.allowPartial&&0==s.replace(/[^0-9]/,"").length)return s;this.strippedValue=s,0==s.length&&(s=NaN);var i=Number(s);if(isNaN(i))return this.throwError(2,"The value entered was not a number.",e);if(0==r.length)return s;var n=String(Math.abs(s.indexOf(".")>-1?s.split(".")[0]:s)),a=s.indexOf(".")>-1?s.split(".")[1]:"",h=a,l=0!=i&&-1*Math.abs(i)==i,o={$:/^[\$]/.test(r),"(":l&&r.indexOf("(")>-1,"+":-1!=r.indexOf("+")&&!l};o["-"]=l&&(!o["("]||-1!=r.indexOf("-"));var c=(r=r.replace(/[^#0.,]*/gi,"")).indexOf(".")>-1?r.split(".")[1]:"";if(0==c.length)n=String(Math.round(Number(n))),a="";else{var g=c.lastIndexOf("0")+1;if(a.length>c.length)a=String(Math.round(Number(a.substring(0,c.length+1))/10));else for(;a.length<g;)a+="0"}var u=r.indexOf(".")>-1?r.split(".")[0]:r,d=(u=u.replace(/[^0#]+/gi,"")).indexOf("0")+1;if(d>0)for(d=u.length-d+1;n.length<d;)n="0"+n;if(/[#0]+,[#0]{3}/.test(r)){for(var p=[],y=0,f=Number(n);f>999;)p[y]="00"+String(f%1e3),p[y]=p[y].substring(p[y].length-3),f=Math.floor(f/1e3),y++;p[y]=String(f%1e3),n=p.reverse().join(",")}return s=a.length>0&&!this.allowPartial||c.length>0&&this.allowPartial&&s.indexOf(".")>-1&&h.length>=a.length?n+"."+a:c.length>0&&this.allowPartial&&s.indexOf(".")>-1&&h.length<a.length?n+"."+h:n,o.$&&(s=this.mask.replace(/(^[\$])(.+)/gi,"$")+s),o["+"]&&(s="+"+s),o["-"]&&(s="-"+s),o["("]&&(s="("+s+")"),s},Mask.prototype.setDate=function(e){var t,s,r,i,n,a,h,l=e,o=this.mask;t=o.split(/[^mdy]+/),h=o.split(/[mdy]+/),s=l.split(/[^0-9]/),0==h[0].length&&h.splice(0,1);for(var c=0;c<t.length;c++)"m"==(a=t[c].charAt(0).toLowerCase())?r=parseInt(s[c],10)-1:"d"==a?i=parseInt(s[c],10):"y"==a&&(n=parseInt(s[c],10));String(n).length<3&&(n=2e3+n,(new Date).getFullYear()+5<n&&(n-=100));var g=new Date(n,r,i);if(g.getDate()!=i)return this.throwError(1,"An invalid day was entered.",e);if(g.getMonth()!=r)return this.throwError(2,"An invalid month was entered.",e);var u="";for(c=0;c<t.length;c++)"m"==(a=t[c].charAt(0).toLowerCase())?(r++,2==t[c].length&&(r=(r="0"+r).substring(r.length-2)),u+=r):"d"==a?(2==t[c].length&&(i=(i="0"+i).substring(i.length-2)),u+=i):"y"==a&&(2==t[c].length?u+=g.getYear():u+=g.getFullYear()),c<t.length-1&&(u+=h[c]);return u},Mask.prototype.setDateKeyPress=function(e,t){var r,i,n,a,h,l,o,c,g=e,u=this.mask,p=g.charAt(g.length-1),y="",f="",k="";if(1==t){for(;/[^0-9]/gi.test(g.charAt(g.length-1));)g=g.substring(0,g.length-1);if(/[^0-9]/gi.test(this.strippedValue.charAt(this.strippedValue.length-1))&&(g=g.substring(0,g.length-1)),0==g.length)return""}r=u.split(/[^mdy]/),s=u.split(/[mdy]+/),0==s[0].length&&s.splice(0,1),n=r[o=(i=g.split(/[^0-9]/)).length>0?i.length-1:0].charAt(0),a=r[o].length;for(var b=0;b<i.length;b++)"m"==(l=r[b].charAt(0).toLowerCase())?y=parseInt(i[b],10)-1:"d"==l?f=parseInt(i[b],10):"y"==l&&(k=parseInt(i[b],10));var v="";for(b=0;b<i.length;b++)"m"==(l=r[b].charAt(0).toLowerCase())?(c=/[^0-9]/.test(p)&&"m"==n,y++,(2==i[b].length&&y<10||2==r[b].length&&"m"!=n||y>1&&"m"==n||c&&2==r[b].length)&&(y=(y="0"+y).substring(y.length-2)),h=String(y).length,a=2,v+=y):"d"==l?(c=/[^0-9]/.test(p)&&"d"==n,(2==i[b].length&&f<10||2==r[b].length&&"d"!=n||f>3&&"d"==n||c&&2==r[b].length)&&(f=(f="0"+f).substring(f.length-2)),h=String(f).length,a=2,v+=f):"y"==l&&(c=/[^0-9]/.test(p)&&"y"==n,k="y"==n?String(k):2==r[b].length?d.getYear():d.getFullYear(),(2==i[b].length&&k<10||2==r[b].length&&"y"!=n||c&&2==r[b].length)&&(k=(k="0"+k).substring(k.length-2)),a=r[b].length,h=String(k).length,v+=k),((a==h||c)&&l==n&&b<s.length||b<s.length&&l!=n)&&(v+=s[b]);return v.length>u.length&&(v=v.substring(0,u.length)),this.strippedValue="NaN"==v?"":v,this.strippedValue},qEvent.prototype.translateKeyCode=function(e){var t={};if(document.layers){if(this.keyCode>96&&this.keyCode<123)return this.keyCode-32;t={96:192,126:192,33:49,64:50,35:51,36:52,37:53,94:54,38:55,42:56,40:57,41:48,92:220,124:220,125:221,93:221,91:219,123:219,39:222,34:222,47:191,63:191,46:190,62:190,44:188,60:188,45:189,95:189,43:187,61:187,59:186,58:186,null:null}}return t[e]?t[e]:e},qEvent.prototype.setKP=function(e,t){return this.keyPressedCode=e,this.keyNonChar="string"==typeof t,this.keyPressed=this.keyNonChar?t:String.fromCharCode(e),this.isNumeric=parseInt(this.keyPressed,10)==this.keyPressed,this.isAlpha=this.keyCode>64&&this.keyCode<91&&!this.altKey&&!this.ctrlKey,!0},qEvent.prototype.setKeyPressed=function(e){var t=this.shiftKey;if(!t&&e>64&&e<91)return this.setKP(e+32);if(e>95&&e<106)return this.setKP(e-48);switch(e){case 49:case 51:case 52:case 53:t&&(e-=16);break;case 50:t&&(e=64);break;case 54:t&&(e=94);break;case 55:t&&(e=38);break;case 56:t&&(e=42);break;case 57:t&&(e=40);break;case 48:t&&(e=41);break;case 192:e=t?126:96;break;case 189:e=t?95:45;break;case 187:e=t?43:61;break;case 220:e=t?124:92;break;case 221:e=t?125:93;break;case 219:e=t?123:91;break;case 222:e=t?34:39;break;case 186:e=t?58:59;break;case 191:e=t?63:47;break;case 190:e=t?62:46;break;case 188:e=t?60:44;break;case 106:case 57379:e=42;break;case 107:case 57380:e=43;break;case 109:case 57381:e=45;break;case 110:e=46;break;case 111:case 57378:e=47;break;case 8:return this.setKP(e,"[backspace]");case 9:return this.setKP(e,"[tab]");case 13:return this.setKP(e,"[enter]");case 16:case 57389:return this.setKP(e,"[shift]");case 17:case 57390:return this.setKP(e,"[ctrl]");case 18:case 57388:return this.setKP(e,"[alt]");case 19:case 57402:return this.setKP(e,"[break]");case 20:return this.setKP(e,"[capslock]");case 32:return this.setKP(e,"[space]");case 91:return this.setKP(e,"[windows]");case 93:return this.setKP(e,"[properties]");case 33:case 57371:return this.setKP(-1*e,"[pgup]");case 34:case 57372:return this.setKP(-1*e,"[pgdown]");case 35:case 57370:return this.setKP(-1*e,"[end]");case 36:case 57369:return this.setKP(-1*e,"[home]");case 37:case 57375:return this.setKP(-1*e,"[left]");case 38:case 57373:return this.setKP(-1*e,"[up]");case 39:case 57376:return this.setKP(-1*e,"[right]");case 40:case 57374:return this.setKP(-1*e,"[down]");case 45:case 57382:return this.setKP(-1*e,"[insert]");case 46:case 57383:return this.setKP(-1*e,"[delete]");case 144:case 57400:return this.setKP(-1*e,"[numlock]")}return e>111&&e<124?this.setKP(-1*e,"[f"+(e-111)+"]"):this.setKP(e)};