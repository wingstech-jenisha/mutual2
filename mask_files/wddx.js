function wddxSerializer_serializeValue(e){var t,i=!0;if(null==e)this.write("<null/>");else if("string"==typeof(t=e.valueOf()))this.serializeString(t);else if("number"==typeof(t=e.valueOf()))"function"==typeof e.getTimezoneOffset&&"function"==typeof e.toGMTString?(this.write("<dateTime>"+(e.getYear()<1e3?1900+e.getYear():e.getYear())+"-"+(e.getMonth()+1)+"-"+e.getDate()+"T"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()),this.useTimezoneInfo&&this.write(this.timezoneString),this.write("</dateTime>")):this.write("<number>"+t+"</number>");else if("boolean"==typeof(t=e.valueOf()))this.write("<boolean value='"+t+"'/>");else if("object"==typeof e)if("function"==typeof e.wddxSerialize)i=e.wddxSerialize(this);else if("function"==typeof e.join&&"function"==typeof e.reverse&&"function"==typeof e.sort&&"number"==typeof e.length){this.write("<array length='"+e.length+"'>");for(var r=0;i&&r<e.length;++r)i=this.serializeValue(e[r]);this.write("</array>")}else{for(var s in"string"==typeof e.wddxSerializationType?this.write('<struct type="'+e.wddxSerializationType+'">'):this.write("<struct>"),e)if("wddxSerializationType"!=s&&!(i=this.serializeVariable(s,e[s])))break;this.write("</struct>")}else i=!1;return i}function wddxSerializer_serializeAttr(e){for(var t=0;t<e.length;++t)this.write(this.at[e.charAt(t)])}function wddxSerializer_serializeAttrOld(e){this.write(e)}function wddxSerializer_serializeString(e){this.write("<string>");for(var t=0;t<e.length;++t)e.charCodeAt(t)>255?this.write(e.charAt(t)):this.write(this.et[e.charAt(t)]);this.write("</string>")}function wddxSerializer_serializeStringOld(e){if(this.write("<string><![CDATA["),pos=e.indexOf("]]>"),-1!=pos){for(startPos=0;-1!=pos;)this.write(e.substring(startPos,pos)+"]]>]]&gt;<![CDATA["),startPos=pos+3,startPos<e.length?pos=e.indexOf("]]>",startPos):pos=-1;this.write(e.substring(startPos,e.length))}else this.write(e);this.write("]]></string>")}function wddxSerializer_serializeVariable(e,t){var i=!0;return"function"!=typeof t&&(this.write("<var name='"),this.preserveVarCase?this.serializeAttr(e):this.serializeAttr(e.toLowerCase()),this.write("'>"),i=this.serializeValue(t),this.write("</var>")),i}function wddxSerializer_write(e){this.wddxPacket[this.wddxPacket.length]=e}function wddxSerializer_writeOld(e){this.wddxPacket+=e}function wddxSerializer_initPacket(){this.wddxPacket=new Array}function wddxSerializer_initPacketOld(){this.wddxPacket=""}function wddxSerializer_extractPacket(){return this.wddxPacket.join("")}function wddxSerializer_extractPacketOld(){return this.wddxPacket}function wddxSerializer_serialize(e){this.initPacket(),this.write("<wddxPacket version='1.0'><header/><data>");var t=this.serializeValue(e);return this.write("</data></wddxPacket>"),t?this.extractPacket():null}function WddxSerializer(){if(""!=navigator.appVersion&&-1==navigator.appVersion.indexOf("MSIE 3.")){for(var et=new Array,n2c=new Array,c2n=new Array,at=new Array,i=0;i<256;++i){var d1=Math.floor(i/64),d2=Math.floor(i%64/8),d3=i%8,c=eval('"\\'+d1.toString(10)+d2.toString(10)+d3.toString(10)+'"');if(n2c[i]=c,c2n[c]=i,i<32&&9!=i&&10!=i&&13!=i){var hex=i.toString(16);1==hex.length&&(hex="0"+hex),et[n2c[i]]="<char code='"+hex+"'/>",at[n2c[i]]=""}else i<128?(et[n2c[i]]=n2c[i],at[n2c[i]]=n2c[i]):(et[n2c[i]]="&#x"+i.toString(16)+";",at[n2c[i]]="&#x"+i.toString(16)+";")}et["<"]="&lt;",et[">"]="&gt;",et["&"]="&amp;",at["<"]="&lt;",at[">"]="&gt;",at["&"]="&amp;",at["'"]="&apos;",at['"']="&quot;",this.n2c=n2c,this.c2n=c2n,this.et=et,this.at=at,this.serializeString=wddxSerializer_serializeString,this.serializeAttr=wddxSerializer_serializeAttr,this.write=wddxSerializer_write,this.initPacket=wddxSerializer_initPacket,this.extractPacket=wddxSerializer_extractPacket}else this.serializeString=wddxSerializer_serializeStringOld,this.serializeAttr=wddxSerializer_serializeAttrOld,this.write=wddxSerializer_writeOld,this.initPacket=wddxSerializer_initPacketOld,this.extractPacket=wddxSerializer_extractPacketOld;var tzOffset=(new Date).getTimezoneOffset();this.timezoneString=tzOffset>=0?"-":"+",this.timezoneString+=Math.floor(Math.abs(tzOffset)/60)+":"+Math.abs(tzOffset)%60,this.preserveVarCase=!1,this.useTimezoneInfo=!0,this.serialize=wddxSerializer_serialize,this.serializeValue=wddxSerializer_serializeValue,this.serializeVariable=wddxSerializer_serializeVariable}function wddxRecordset_isColumn(e){return"object"==typeof this[e]&&-1==e.indexOf("_private_")}function wddxRecordset_getRowCount(){var e=0;for(var t in this)if(this.isColumn(t)){e=this[t].length;break}return e}function wddxRecordset_addColumn(e){for(var t=this.getRowCount(),i=new Array(t),r=0;r<t;++r)i[r]=null;this[this.preserveFieldCase?e:e.toLowerCase()]=i}function wddxRecordset_addRows(e){for(var t in this)if(this.isColumn(t))for(var i=this[t].length,r=i;r<i+e;++r)this[t][r]=null}function wddxRecordset_getField(e,t){return this[this.preserveFieldCase?t:t.toLowerCase()][e]}function wddxRecordset_setField(e,t,i){this[this.preserveFieldCase?t:t.toLowerCase()][e]=i}function wddxRecordset_wddxSerialize(e){var t="",i=new Array,r=0;for(var s in this)this.isColumn(s)&&(i[r++]=s,t.length>0&&(t+=","),t+=s);var d=this.getRowCount();e.write("<recordset rowCount='"+d+"' fieldNames='"+t+"'>");var a=!0;for(r=0;a&&r<i.length;r++){var n=i[r];e.write("<field name='"+n+"'>");for(var o=0;a&&o<d;o++)a=e.serializeValue(this[n][o]);e.write("</field>")}return e.write("</recordset>"),a}function wddxRecordset_dump(e){var t=this.getRowCount(),i=new Array,r=0;for(var s in this)"object"==typeof this[s]&&(i[r++]=s);var d="<table border=1><tr><td><b>RowNumber</b></td>";for(r=0;r<i.length;++r)d+="<td><b>"+i[r]+"</b></td>";d+="</tr>";for(var a=0;a<t;++a){for(d+="<tr><td>"+a+"</td>",r=0;r<i.length;++r){var n=this.getField(a,i[r]);if(e&&"string"==typeof n){for(var o="",l=0;l<n.length;++l){var h=n.charAt(l);o+="<"==h?"&lt;":">"==h?"&gt;":"&"==h?"&amp;":h}d+="<td>"+o+"</td>"}else d+="<td>"+n+"</td>"}d+="</tr>"}return d+="</table>"}function WddxRecordset(){if(this.preserveFieldCase=!1,"object"==typeof wddxRecordsetExtensions)for(var e in wddxRecordsetExtensions)this[e]=wddxRecordsetExtensions[e];if(this.getRowCount=wddxRecordset_getRowCount,this.addColumn=wddxRecordset_addColumn,this.addRows=wddxRecordset_addRows,this.isColumn=wddxRecordset_isColumn,this.getField=wddxRecordset_getField,this.setField=wddxRecordset_setField,this.wddxSerialize=wddxRecordset_wddxSerialize,this.dump=wddxRecordset_dump,WddxRecordset.arguments.length>0)if("boolean"==typeof(val=WddxRecordset.arguments[0].valueOf()))this.preserveFieldCase=WddxRecordset.arguments[0];else{var t=WddxRecordset.arguments[0],i=0;WddxRecordset.arguments.length>1&&("boolean"==typeof(val=WddxRecordset.arguments[1].valueOf())?this.preserveFieldCase=WddxRecordset.arguments[1]:(i=WddxRecordset.arguments[1],WddxRecordset.arguments.length>2&&(this.preserveFieldCase=WddxRecordset.arguments[2])));for(var r=0;r<t.length;++r){for(var s=new Array(i),d=0;d<i;++d)s[d]=null;this[this.preserveFieldCase?t[r]:t[r].toLowerCase()]=s}}}function registerWddxRecordsetExtension(e,t){"string"==typeof e&&"function"==typeof t&&("object"!=typeof wddxRecordsetExtensions&&(wddxRecordsetExtensions=new Object),wddxRecordsetExtensions[e]=t)}function wddxBinary_wddxSerialize(e){return e.write("<binary encoding='"+this.encoding+"'>"+this.data+"</binary>"),!0}function WddxBinary(e,t){this.data=null!=e?e:"",this.encoding=null!=t?t:"base64",this.wddxSerialize=wddxBinary_wddxSerialize}